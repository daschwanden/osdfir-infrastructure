apiVersion: batch/v1
kind: Job
metadata:
  name: job-create-dirs
  namespace: openrelik
spec:
  template:
    spec:
      containers:
      - name: create-dirs
        image: busybox:1.37
        command: ['sh', '-c', "rm -rf /usr/share/openrelik/* ; mkdir -p /usr/share/openrelik/data/postgresql; mkdir -p /usr/share/openrelik/data/artifacts; mkdir -p /usr/share/openrelik/config"]
        volumeMounts:
        - name: vol-filestore
          mountPath: /usr/share/openrelik
      restartPolicy: Never
      volumes:
        - name: vol-filestore
          persistentVolumeClaim:
            claimName: pvc-filestore
  backoffLimit: 4
